jobs:
- job: Test
  strategy:
    parallel: 10

  pool:
    vmImage: windows-2019
  steps:
    - task: DownloadBuildArtifacts@0
      inputs:
        buildType: 'specific'
        project: 'dc0010e5-9ecf-45ac-b89d-2d51897f3855'
        pipeline: '23'
        buildVersionToDownload: 'latestFromBranch'
        branchName: 'refs/heads/lab'
        downloadType: 'single'
        downloadPath: '$(System.DefaultWorkingDirectory)'
        artifactName: 'Xpand.XAF.Modules.Bin'
    - task: VSTest@2
      displayName: 'VsTest - testAssemblies'
      inputs:
        searchFolder: '$(System.DefaultWorkingDirectory)'
        testSelector: 'testAssemblies'
        testAssemblyVer2: |
          **\*Reactive.Logger.Hub.Tests*.dll
          **\*Auto*.dll
          **\*CloneMemberValue*.dll
          **\*CloneModelView*.dll
          **\*GridListEditor*.dll
          **\*HideToolBar*.dll
          **\*MasterDetail*.dll
          **\*ProgressBarViewItem*.dll
          **\*SuppressConfirmation*.dll
          **\*ViewEditMode*.dll
          **\*Inherit*.dll
          !**\*TestAdapter.dll
          !**\obj\**
        
        diagnosticsEnabled: true
        runInParallel: true
        
        distributionBatchType: 'basedOnAssembly'
      
        collectDumpOn: never
    